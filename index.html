<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏™‡∏ß‡∏µ‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡∏™‡πÇ‡∏ï‡∏£‡∏Å Quiz</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@100..900&display=swap" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body { font-family: "Noto Sans Thai"; background: #f5f5f5; padding: 16px; margin: 0; }
    .container { max-width: 400px; margin: 0 auto; background: #fff; padding: 16px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #003366; margin-bottom: 20px; }

    /* Progress Bar */
    #progressContainer { background: #e9ecef; border-radius: 8px; height: 10px; margin-bottom: 16px; overflow: hidden; }
    #progressBar { background: #007BFF; height: 100%; width: 0%; transition: width 0.4s ease; }

    /* Question Animation */
    #questionContainer { opacity: 0; animation: fadeInUp 0.5s forwards; }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .question p { font-weight: bold; margin: 0 0 12px; }
    .question label { display: block; margin-bottom: 8px; cursor: pointer; }

    #explanation { margin-top: 12px; color: #dc3545; }

    .btn { display: block; width: 100%; padding: 12px; background: #007BFF; color: #fff; border: none; border-radius: 8px; margin-top: 16px; cursor: pointer; }
    .btn:hover { background: #0056b3; }

    #result { display: none; text-align: center; margin-top: 20px; }
    #result h2 { margin-bottom: 12px; }
    #result p { margin: 8px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h1>‡∏™‡∏ß‡∏µ‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡∏™‡πÇ‡∏ï‡∏£‡∏Å Quiz</h1>

    <!-- Progress -->
    <div id="progressContainer"><div id="progressBar"></div></div>

    <!-- Question -->
    <div id="questionContainer">
      <div class="question" id="questionText"></div>
      <div id="options"></div>
      <div id="explanation"></div>
    </div>

    <!-- Next Button -->
    <button id="nextBtn" class="btn" style="display:none;">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>

    <!-- Result -->
    <div id="result">
      <h2 id="resultTitle"></h2>
      <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <span id="score"></span>/10</p>
      <button id="shareBtn" class="btn">‡πÅ‡∏ä‡∏£‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
    </div>
  </div>

<script>
const liffId  = '2005789397-ROQvjpYk';
const GAS_URL = 'https://script.google.com/macros/s/AKfycbzDE6SfY8Mabbwn-ojHWmNbqov0XYtpHZqFiOzM9SnISPnPNhOuy7x3wZj1lsV_CtvOFA/exec';

let userId = '', userName = '';
const totalQ = 10;
let currentQ = 0;
let correctCount = 0;
const answers = [];

// 10 ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î
const quizData = [
  { q:'1. Stroke ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏≠‡∏∞‡πÑ‡∏£?', opts:['‡∏™‡∏°‡∏≠‡∏á‡∏Ç‡∏≤‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏î','‡∏™‡∏°‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠','‡∏™‡∏°‡∏≠‡∏á‡∏Ç‡∏≤‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô','‡∏™‡∏°‡∏≠‡∏á‡∏ó‡∏±‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î'], a:0, exp:'Stroke ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏™‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å‡πÉ‡∏ô‡∏™‡∏°‡∏≠‡∏á' },
  { q:'2. ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÉ‡∏î?', opts:['‡∏≠‡∏≤‡∏¢‡∏∏‡∏™‡∏π‡∏á','‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô','‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà','‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß'], a:2, exp:'‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ' },
  { q:'3. ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÉ‡∏î?', opts:['‡∏≠‡∏≤‡∏¢‡∏∏‡∏™‡∏π‡∏á','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á','‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏™‡∏π‡∏á','‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà'], a:0, exp:'‡∏≠‡∏≤‡∏¢‡∏∏‡∏™‡∏π‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ' },
  { q:'4. B ‡πÉ‡∏ô BE-FAST ‡∏¢‡πà‡∏≠‡∏°‡∏≤‡∏à‡∏≤‡∏Å?', opts:['Balance (‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏™‡∏µ‡∏¢)','Blink','Breathing','Blood'], a:0, exp:'B = Balance (‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏™‡∏µ‡∏¢)' },
  { q:'5. E ‡πÉ‡∏ô BE-FAST ‡∏Ñ‡∏∑‡∏≠?', opts:['Eyes (‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î)','Exercise','Eat','Energy'], a:0, exp:'E = Eyes (‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î)' },
  { q:'6. S ‡πÉ‡∏ô BE-FAST ‡∏¢‡πà‡∏≠‡∏°‡∏≤‡∏à‡∏≤‡∏Å?', opts:['Speech (‡∏û‡∏π‡∏î‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î)','Smile','Shock','Sense'], a:0, exp:'S = Speech (‡∏û‡∏π‡∏î‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î)' },
  { q:'7. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏™‡πÇ‡∏ï‡∏£‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å?', opts:['‡πÇ‡∏ó‡∏£ 1669','‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥','‡∏ô‡∏≠‡∏ô‡∏û‡∏±‡∏Å','‡πÑ‡∏õ‡∏´‡∏≤‡∏´‡∏°‡∏≠‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ'], a:0, exp:'‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏ó‡∏£ 1669 ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ' },
  { q:'8. rtPA ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏µ‡πà‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á?', opts:['4.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á','6 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á','3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á','2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á'], a:0, exp:'rtPA ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏´‡∏•‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£' },
  { q:'9. ‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô LINE ‡πÉ‡∏ä‡πâ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏î?', opts:['‡πÅ‡∏ä‡∏£‡πå‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á','‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà','‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡πà‡∏≤','‡πÇ‡∏ó‡∏£‡∏ö‡∏≠‡∏Å‡∏õ‡∏≤‡∏Å‡πÄ‡∏õ‡∏•‡πà‡∏≤'], a:0, exp:'‡πÉ‡∏ä‡πâ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ‚Äú‡πÅ‡∏ä‡∏£‡πå‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‚Äù ‡πÉ‡∏ô LINE' },
  { q:'10. ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏ó‡∏£‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡πÉ‡∏ô LINE ‡∏™‡∏ß‡∏µ‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡∏™‡πÇ‡∏ï‡∏£‡∏Å ‡∏Ñ‡∏∑‡∏≠?', opts:['‡πÇ‡∏ó‡∏£‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô 1669','‡πÇ‡∏ó‡∏£ 191','‡∏™‡πà‡∏á‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå','‡πÇ‡∏ó‡∏£ 1442'], a:0, exp:'‡∏õ‡∏∏‡πà‡∏° ‚Äú‡πÇ‡∏ó‡∏£‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô 1669‚Äù ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å' }
];

// ‡πÄ‡∏£‡∏¥‡πà‡∏° LIFF
async function init() {
  await liff.init({ liffId });
  if (!liff.isLoggedIn()) await liff.login();
  const prof = await liff.getProfile();
  userId   = prof.userId;
  userName = prof.displayName;
  showQuestion();
}

// ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
function showQuestion() {
  $('#explanation').hide().text('');
  $('#nextBtn').hide();
  const data = quizData[currentQ];
  $('#questionText').text(data.q);
  $('#options').empty();
  data.opts.forEach((opt,i) => {
    $('#options').append(`
      <label>
        <input type="radio" name="opt" value="${i}"> ${opt}
      </label>`);
  });
  // progress
  const pct = ((currentQ)/totalQ)*100;
  $('#progressBar').css('width', pct + '%');
  $('#questionContainer').css('opacity', 0).show().animate({opacity:1, top:0}, 400);
}

// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß
$(document).on('change','input[name=opt]',function(){
  const selected = parseInt($(this).val());
  const correct  = quizData[currentQ].a;
  let msg = '';
  if (selected === correct) {
    correctCount++;
    msg = '‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!';
  } else {
    msg = '‚ùå ‡∏ú‡∏¥‡∏î: ' + quizData[currentQ].exp;
  }
  answers.push(selected===correct?1:0);
  $('#explanation').show().text(msg);
  $('#nextBtn').show();
});

// ‡∏õ‡∏∏‡πà‡∏° Next
$('#nextBtn').click(()=>{
  currentQ++;
  if (currentQ < totalQ) {
    showQuestion();
  } else {
    showResult();
  }
});

// ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ
function showResult() {
  $('#questionContainer, #nextBtn').hide();
  const title = correctCount >= 8
    ? `${userName} ‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡∏™‡πÇ‡∏ï‡∏£‡∏Å! üéâ`
    : `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ ${correctCount} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`;
  $('#resultTitle').text(title);
  $('#score').text(correctCount);
  // progress full
  $('#progressBar').css('width','100%');
  $('#result').show();
  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•
  $.post(GAS_URL, JSON.stringify({ userId, answers }), null, 'json');
}

// ‡πÅ‡∏ä‡∏£‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡πâ‡∏ß‡∏¢ Flex
$('#shareBtn').click(()=>{
  const flex = {
    type: 'flex',
    altText: '‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πÇ‡∏ï‡∏£‡∏Å',
    contents: {
      type: 'bubble',
      body: {
        type: 'box',
        layout: 'vertical',
        contents: [
          { type: 'text', text: $('#resultTitle').text(), weight:'bold', size:'lg' },
          { type: 'text', text: `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${correctCount}/10`, margin:'md' }
        ]
      }
    }
  };
  liff.shareTargetPicker([flex]).catch(console.error);
});

$(document).ready(init);
</script>
</body>
</html>
